<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <style>
        body { font-family: sans-serif; font-size: 11px; }
        .invoice-block { border: 1px solid #000; margin-bottom: 20px; padding: 10px; page-break-inside: avoid; }
        .inv-header { font-weight: bold; border-bottom: 1px solid #eee; margin-bottom: 5px; font-size: 13px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 4px; text-align: left; }
        .total { text-align: right; font-weight: bold; margin-top: 5px; }


    @media print {
    @page {
        margin: 0; /* Убирает отступы, где печатаются колонтитулы */
    }
    body {
        margin: 1.5cm; /* Добавляет отступ уже самому контенту, чтобы текст не прилипал к краю листа */
    }
}


    </style>
</head>
<body>
<div th:each="op : ${payload}" class="invoice-block">
    <div class="inv-header">
        Контрагент (Магазин): <span th:text="${op.shopName}"></span>
        <span style="float:right">№ [[${op.id}]]</span>
    </div>
    <table>
        <thead>
        <tr><th>№</th><th>Наименование товара</th><th>Кол-во</th><th>Цена</th><th>Сумма</th></tr>
        </thead>
        <tbody>
        <tr th:each="entry, stat : ${op.items}">
            <td th:text="${stat.index + 1}"></td>
            <!-- Получаем имя товара по ID -->
            <td th:text="${productRepo.findById(entry.key).get().name}"></td>
            <td th:text="${entry.value + ' шт.'}"></td>
            <td th:text="${#numbers.formatInteger(productRepo.findById(entry.key).get().price, 1, 'WHITESPACE') + ' ֏'}"></td>
            <td th:text="${#numbers.formatInteger(productRepo.findById(entry.key).get().price * entry.value, 1, 'WHITESPACE') + ' ֏'}"></td>
        </tr>
        </tbody>
    </table>
    <div class="total">
        ИТОГО: <span th:text="${#numbers.formatInteger(op.totalAmount, 1, 'WHITESPACE') + ' ֏'}"></span>
    </div>
</div>
</body>
</html>
